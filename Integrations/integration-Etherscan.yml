commonfields:
  id: EtherScan
  version: -1
name: EtherScan
display: EtherScan
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,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
description: EtherScan is a Block Explorer, Search, API and Analytics Platform for
  Ethereum, a decentralized smart contracts platform.
configuration:
- display: API URL
  name: url
  defaultvalue: https://api.etherscan.io/api
  type: 0
  required: true
- display: API Key
  name: key
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |
    import requests

    url = demisto.getParam('url')
    key = demisto.getParam('key')

    WEI = 1000000000000000000

    session = requests.Session()

    if demisto.command() == 'test-module':
        r = session.get(url, params={'module': 'account', 'action': 'balance', 'address': '0xde0b295669a9fd93d5f28d9ec85e40f4cb697bae'})
        r.raise_for_status()

        demisto.results('ok')

    elif demisto.command() == 'wallet-balance':
        r = session.get(url, params={'module': 'account', 'action': 'balance', 'address': demisto.getArg('address'), 'apiKey': key})
        r.raise_for_status()

        demisto.results(int(r.json()['result']) / WEI)

    elif demisto.command() == 'wallet-txlist':
        r = session.get(url, params={'module': 'account', 'action': 'txlist', 'address': demisto.getArg('address'), 'apiKey': key,
                                     'startblock': demisto.getArg('startblock'), 'endblock': demisto.getArg('endblock')})
        r.raise_for_status()

        demisto.results({'txlist': r.json()['result']})
  type: python
  commands:
  - name: wallet-balance
    arguments:
    - name: address
      required: true
      description: Wallet address
    description: Get balance for an ethereum wallet
  - name: wallet-txlist
    arguments:
    - name: address
      required: true
      description: Wallet address      
    - name: startblock
      description: Starting blockNo to retrieve results
      defaultValue: "0"
    - name: endblock
      default: true
      description: Ending blockNo to retrieve results
      defaultValue: "99999999"
    description: Get list of transaction list for wallet
  runonce: false
releaseNotes: "Added EtherScan integration"

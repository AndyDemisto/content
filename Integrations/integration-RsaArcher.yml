commonfields:
  id: RSA Archer
  version: -1
name: RSA Archer
display: RSA Archer
category: Case Management
image: data:image/png;base64,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
description: The RSA Archer GRC Platform provides a common foundation for managing
  policies, controls, risks, assessments and deficiencies across lines of business.
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Instance name
  name: instanceName
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |
    var server = params.server.replace(/[\/]+$/, '') + '/api/core/';

    var urlDictionary = {
        login: 'security/login',
        logout: 'security/logout',

        'archer-create-record': 'content',
        'archer-udpate-record': 'content',
        'archer-get-record': 'content/%id%',
        'archer-list-records': 'system/application',
    };

    var methodDictionary = {
        login: 'POST',
        logout: 'POST',

        'archer-create-record': 'POST',
        'archer-udpate-record': 'POST',
        'archer-get-record': 'GET',
        'archer-list-records': 'GET',
    };

    // For archer-create-record, archer-update-record
    var buildCommandBody = function(command, args) {
        var content = {
            LevelId: 191,
            FieldContents: {
                '13867': {
                    Type: 1,
                    Value: args.name,
                    FieldId: 13867
                },
                '13868': {
                    Type: 1,
                    Value: args.description,
                    FieldId: 13868
                }
            }
        }

        if (command == 'archer-update-record') {
            content.Id = args.id;
        }

        return {'Content': content};
    }

    var entriesFromResponse = function(command, response) {
        var entry = {Type: entryTypes.note, Contents: null, ContentsFormat: formats.json, EntryContext: {}};
        switch (command) {
            case 'archer-create-record':
                if ((response.IsSuccessful !== true) || (response.ValidationMessages.length !== 0)) {
                    throw 'Create record failed, validation messages = ' + JSON.stringify(response.ValidationMessages);
                }
                entry = 'Record ID: ' + response.RequestedObject.Id;
                break;

            case 'archer-update-record':
                if ((response.IsSuccessful !== true) || (response.ValidationMessages.length !== 0)) {
                    throw 'Update record failed, validation messages = ' + JSON.stringify(response.ValidationMessages);
                }
                entry = 'Update is successful.';
                break;

            case 'archer-get-record':
                entry = response.RequestedObject.FieldContents;
                break;

            case 'archer-list-records':
                outputs = [];
                for (var i = 0; i < response.length; i++) {
                    outputs.push(response[i].RequestedObject);
                }
                entry.HumanReadable = tblToMd('RSA Archer Records', outputs);
                entry.EntryContext['RSA_Archer.Records'] = response;
                break;

            default:
                throw 'Unsupported command.';
        }

        return entry;
    }

    var sendRequest = function(method, url, token, args) {
        var headers = {'Content-Type': ['application/json']};
        if (token) {
            headers['Authorization'] = ['Archer session-id=' + token];
            if (method == 'GET') {
                headers['X-Http-Method-Override'] = ['GET'];
            }
        }

        var body = JSON.stringify(args);
        console.log('Sending request: ' + server + url + ' with header: ' + JSON.stringify(headers) + ' and body: ' + JSON.stringify(body));
        var res = http(
            server + url,
            {
                Method: method,
                Headers: headers,
                Body: body
            },
            params.insecure,
            params.proxy
        );

        console.log('res = ' + JSON.stringify(res));

        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            if (token && (url.indexOf('logout') == -1)) {
                sendRequest(methodDictionary.logout, urlDictionary.logout, token, {Value: token});
            }
            throw 'Request to RSA Archer ' + url + ' failed, request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
        }

        return JSON.parse(res.Body);
    }

    var result = sendRequest(
        methodDictionary.login,
        urlDictionary.login,
        undefined,
        {
            InstanceName: params.instanceName,
            Username: params.credentials.identifier,
            Password: params.credentials.password
        }
    );

    if (result.IsSuccessful !== true) {
        throw 'Login failed. Result = ' + JSON.stringify(result);
    }

    var token = result.RequestedObject.SessionToken;
    var commandArgs = {};
    switch (command) {
        case 'test-module':
            result = sendRequest(methodDictionary.logout, urlDictionary.logout, token, {Value: token});
            return 'ok';

        case 'archer-create-record':
        case 'archer-update-record':
            commandArgs = buildCommandBody(command, args);
            break;

        default:
            break;
    }

    console.log('command = ' + command + ', commandArgs = ' + JSON.stringify(commandArgs));
    result = sendRequest(methodDictionary[command], replaceInTemplatesAndRemove(urlDictionary[command], args), token, commandArgs);
    var entries = entriesFromResponse(command, result);
    sendRequest(methodDictionary.logout, urlDictionary.logout, token, {Value: token});
    return entries;
  type: javascript
  commands:
  - name: archer-create-record
    arguments:
    - name: name
      required: true
      description: The name of the Content Record.
    - name: description
      required: true
      description: The description of the Content Record (html).
    description: Creates a new Content Record.
  - name: archer-update-record
    arguments:
    - name: id
      required: true
      description: The Content Record ID to update.
    - name: name
      required: true
      description: The name of the Content Record, after updating.
    - name: description
      required: true
      description: The description of the Content Record (html), after updating.
    description: Updates the value of a field of a Content Record.
  - name: archer-get-record
    arguments:
    - name: id
      required: true
    description: Gets information about a Content Record.
  - name: archer-list-records
    arguments: []
    description: Gets a list of Content Records in an application.
hidden: false

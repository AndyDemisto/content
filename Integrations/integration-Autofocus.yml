commonfields:
  id: Autofocus
  version: -1
name: Autofocus
display: Autofocus
category: Threat Intelligence
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAyCAYAAAAweqkjAAAACXBIWXMAAAsTAAALEwEAmpwYAAA4ImlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wMi0xNlQyMDo0NToyMCswMjowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE2LTAzLTA3VDE5OjM1KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wMy0wN1QxOTozNSswMjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpmN2I2ZWQzMi1jNzIxLTRiMjMtYmE2Mi1iMmY0NWNjNWM2M2Y8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnhtcC5kaWQ6ZjdiNmVkMzItYzcyMS00YjIzLWJhNjItYjJmNDVjYzVjNjNmPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6ZjdiNmVkMzItYzcyMS00YjIzLWJhNjItYjJmNDVjYzVjNjNmPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y3JlYXRlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmY3YjZlZDMyLWM3MjEtNGIyMy1iYTYyLWIyZjQ1Y2M1YzYzZjwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMi0xNlQyMDo0NToyMCswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjM4PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjUwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg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
description: PaloAlto Networks Autofocus
detaileddescription: |-
  Step 1: Login and add your authorization code
  1. Visit [PAN support](https://support.paloaltonetworks.com).
  2. Select the Assets > Site Licenses tab.
  3. Select Add Site License.
  4. Enter the authorization code.
  Step 2: Activate the API.
  1. Select the Enable action in Site Licenses.
  2. Select the API Key link.

  The API key appears onscreen as shown below. Use this API
  key for all AutoFocus API requests
configuration:
- display: Server URL
  name: server
  defaultvalue: https://autofocus.paloaltonetworks.com/
  type: 0
  required: true
- display: Version
  name: version
  defaultvalue: v1.0
  type: 0
  required: true
- display: API Key
  name: apiKey
  defaultvalue: ""
  type: 4
  required: true
- display: Use system proxy settings
  name: useproxy
  defaultvalue: "true"
  type: 8
  required: false
- display: Allow self-signed SSL certificates
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |
    var server = params.server.replace(/[\/]+$/, '') + '/api/' + params.version + '/';

    var doReq = function(path, data) {
        data.apiKey = params.apiKey;
        data.apiKey = params.apiKey;
        var result = http(
            server + path,
            {
                Headers: {'Content-Type': ['application/json'], 'Accept': ['application/json']},
                Method: 'POST',
                Body: JSON.stringify(data)
            },
            params.insecure,
            params.useproxy
        );

        if (result.StatusCode < 200 || result.StatusCode > 299) {
            throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode + '\n' + result.Body;
        }
        if (result.Body === '') {
            throw 'No content received.';
        }
        var obj;
        try {
            obj = JSON.parse(result.Body);
        } catch (ex) {
            throw 'Error parsing reply - ' + result.Body + ' - ' + ex;
        }
        return {body: result.Body, obj: obj, statusCode: result.StatusCode};
    };

    var doSearch = function(prefix) {
        var cookie = args.cookie;
        if (!cookie) {
            var q = {};
            q.query = JSON.parse(args.query);
            q.from = parseInt(args.from);
            q.size = parseInt(args.size);
            if (args.sort) {
                q.sort = {};
                q.sort[args.sort] = {order: (args.order ? args.order : 'asc')};
            }
            if (args.scope) {
                q.scope = args.scope;
            }
            var res = doReq(prefix + '/search/', q);
            if (!res.obj.af_cookie) {
                throw 'Unable to retrieve cookie of search results';
            }
            cookie = res.obj.af_cookie;
        }
        var checks = (args.checks) ? parseInt(args.checks) : 10;
        var sleep = (args.sleep) ? parseInt(args.sleep) : 3;
        var res1;
        var ec = {'Autofocus.Cookie': cookie};
        while (checks > 0) {
            checks--;
            wait(sleep);
            res1 = doReq(prefix + '/results/' + cookie, {});
            if (res1.obj.af_message === 'complete' || res1.obj.af_in_progress === false || res1.obj.hits.length >= parseInt(args.size)) {
                var md = '## PAN Autofocus ' + prefix + ' result\n';
                md += 'Total: ' + res1.obj.total + '\nTook: ' + res1.obj.took + '\n';
                var hits = [];
                for (var i=0; i<res1.obj.hits.length; i++) {
                    var data = res1.obj.hits[i]._source;
                    data.id = res1.obj.hits[i]._id;
                    hits.push(data);
                }
                ec['Autofocus.S' + prefix.substr(1)] = hits;
                md += tableToMarkdown('S' + prefix.substr(1), hits);
                return {Type: entryTypes.note, Contents: res1.body, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec};
            }
        }
        return {Type: entryTypes.note, Contents: ec, ContentsFormat: formats.json,
            HumanReadable: 'PAN Autofocus timeout occured waiting for results, cookie is: ' + cookie, EntryContext: ec
        };
    };

    var doSession = function(id) {
        var res = doReq('session/' + id, {});
        if (res.obj.af_message === 'complete' || res.obj.af_in_progress === false || res.obj.hits.length >= 1) {
            var hits = [];
            for (var i=0; i<res.obj.hits.length; i++) {
                var data = res.obj.hits[i]._source;
                data.id = res.obj.hits[i]._id;
                hits.push(data);
            }
            md = tableToMarkdown('PAN Autofocus session details', hits);
            md += 'Took: ' + res.obj.took + '\n';
            return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md, EntryContext: {'Autofocus.Sessions': hits}};
        }
        return {Type: entryTypes.note, ContentsFormat: formats.markdown, Contents: 'PAN Autofocus no session for: ' + id};
    };

    var doSample = function() {
        var p = {};
        if (args.sections) {
            p.sections = argToList(args.sections);
        }
        if (args.platforms) {
            p.platforms = argToList(args.platforms);
        }
        if (args.coverage === 'true') {
            p.coverage = true;
            if (p.sections && p.sections.indexOf('coverage') < 0) {
                p.sections.push('coverage');
            }
        }
        var res = doReq('sample/' + args.id + '/analysis', p);
        md = '## PAN Autofocus Sample Analysis\n';
        md += '### Sections: ' + res.obj.sections.join(', ') + '\n';
        md += '### Platforms: ' +  res.obj.platforms.join(', ') + '\n';
        if (res.obj.coverage) {
            Object.keys(res.obj.coverage).forEach(function(s) {
                md += tableToMarkdown('Coverage ' + s, res.obj.coverage[s]) + '\n';
            });
        }
        res.obj.sections.forEach(function(s) {
            if (s === 'coverage') {
                return;
            }
            res.obj.platforms.forEach(function(p) {
                md += tableToMarkdown(s + ' - ' + p, res.obj[s][p]) + '\n';
            });
        });
        return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md};
    };

    switch (command) {
        case 'test-module':
            doReq('samples/search/', {query: {operator: 'all', children: [{field: 'sample.malware', operator: 'is', value: 1}]}, size: 1, from: 0, scope: 'public'});
            return 'ok';
        case 'autofocus-search-samples':
            return doSearch('samples');
        case 'autofocus-search-sessions':
            return doSearch('sessions');
        case 'autofocus-session':
            return doSession(args.id);
        case 'autofocus-sample-analysis':
            return doSample(args.id);
        case 'file':
            args.size = 1;
            args.from = 0;
            args.scope = 'public';
            var hash = args.file.length === 64 ? 'sha256' : args.file.length === 40 ? 'sha1' : 'md5';
            args.query = JSON.stringify({operator: 'all', children: [{field: 'sample.' + hash, operator: 'is', value: args.file}]});
            var search = doSearch('samples');
            if (search.EntryContext && search.EntryContext['Autofocus.Samples'] && search.EntryContext['Autofocus.Samples'].length > 0) {
                var c = search.EntryContext['Autofocus.Samples'][0];
                var dbotScore = [];
                ['md5', 'sha1', 'sha256'].forEach(function(h) {
                    if (c[h]) {
                        dbotScore.push({Indicator: c[h], Type: 'hash', Vendor: 'PAN Autofocus', Score: c.malware === 1 ? 3 : 1,
                            Description: c.tag && c.tag.length > 0 ? c.tag.join(', ') : c.malware === 1 ? 'Marked as malware' : ''});
                    }
                });
                var ec = {DBotScore: dbotScore};
                var f = {MD5: c.md5, SHA1: c.sha1, SHA256: c.sha256, Size: c.size, SSDeep: c.ssdeep, Region: c.region ? c.region.join(',') : '', Info: c.filetype, Type: c.filetype};
                if (c.malware === 1) {
                    f.properties_to_append = ['Malicious'];
                    f.Malicious = {Vendor: 'PAN Autofocus', Description: dbotScore[0].Description};
                }
                ec[outputPaths.file] = f;
                // Now, let's add any interesting sessions we've encountered to the display
                args.size = 50;
                delete args.scope;
                args.query = JSON.stringify({operator: 'all', children: [{field: 'session.sha256', operator: 'is', value: c.sha256}]});
                var md = search.HumanReadable;
                var sessions = doSearch('sessions');
                if (sessions.EntryContext && sessions.EntryContext['Autofocus.Sessions'] && sessions.EntryContext['Autofocus.Sessions'].length > 0) {
                    md += '\n' + sessions.HumanReadable;
                }
                return {Type: entryTypes.note, Contents: search.Contents, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec};
            }
            return {Type: entryTypes.note, ContentsFormat: formats.markdown, Contents: 'PAN Autofocus no data for: ' + args.file};
        default:
            throw 'Unknown command "' + command + '"';
    }
  type: javascript
  commands:
  - name: autofocus-search-samples
    arguments:
    - name: scope
      auto: PREDEFINED
      predefined:
      - private
      - public
      - global
      description: The scope for the search
      defaultValue: public
    - name: size
      description: Number of results
      defaultValue: "50"
    - name: from
      description: Sample number to start from
      defaultValue: "0"
    - name: sort
      auto: PREDEFINED
      predefined:
      - app_name
      - app_packagename
      - filetype
      - size
      - finish_date
      - create_date
      - update_date
      - md5
      - sha1
      - sha256
      - ssdeep
      description: Sort field
    - name: order
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: Order of sort
    - name: query
      required: true
      description: The query to retrieve samples
    - name: sleep
      description: Time to sleep between checking for results
      defaultValue: "3"
    - name: checks
      description: Number of checks before giving up on the query
      defaultValue: "10"
    - name: cookie
      description: The af_cookie for retrieving previous search results
    outputs:
    - contextPath: Autofocus.Cookie
      description: The cookie for the results
    - contextPath: Autofocus.Samples.id
      description: ID of sample
    - contextPath: Autofocus.Samples.md5
      description: MD5 of the sample
    - contextPath: Autofocus.Samples.sha1
      description: SHA1 of the sample
    - contextPath: Autofocus.Samples.sha256
      description: SHA256 of the sample
    - contextPath: Autofocus.Samples.app_name
      description: Application name (if exists)
    - contextPath: Autofocus.Samples.size
      description: The size of the sample
    - contextPath: Autofocus.Samples.ssdeep
      description: SSDeep of the sample
    - contextPath: Autofocus.Samples.create_date
      description: The create date for the sample
    - contextPath: Autofocus.Samples.finish_date
      description: The finish date for the sample
    - contextPath: Autofocus.Samples.malware
      description: A flag (0/1) if this is malware
    - contextPath: Autofocus.Samples.app_packagename
      description: The sample package name (if exists)
    - contextPath: Autofocus.Samples.filetype
      description: The sample type
    - contextPath: Autofocus.Samples.region
      description: Where have we seen this sample
    - contextPath: Autofocus.Samples.tag
      description: Sample tags
    description: Search for samples on Autofocus
  - name: autofocus-search-sessions
    arguments:
    - name: size
      description: Number of results
      defaultValue: "50"
    - name: from
      description: Sample number to start from
      defaultValue: "0"
    - name: sort
      auto: PREDEFINED
      predefined:
      - app
      - device_country
      - device_countrycode
      - device_hostname
      - device_serial
      - vsys
      - dst_country
      - dst_countrycode
      - dst_ip
      - dst_port
      - emailsbjcharset
      - device_industry
      - src_country
      - src_countrycode
      - src_ip
      - src_port
      - sha256
      - tstamp
      - upload_src
      description: Sort field
    - name: order
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: Order of sort
    - name: query
      required: true
      description: The query to retrieve samples
    - name: sleep
      description: Time to sleep between checking for results
      defaultValue: "3"
    - name: checks
      description: Number of checks before giving up on the query
      defaultValue: "10"
    - name: cookie
      description: The af_cookie for retrieving previous search results
    outputs:
    - contextPath: Autofocus.Cookie
      description: The cookie for the results
    - contextPath: Autofocus.Sessions.id
      description: ID of the session
    - contextPath: Autofocus.Sessions.device_industry
      description: Device industry
    - contextPath: Autofocus.Sessions.filename
      description: The name of the file
    - contextPath: Autofocus.Sessions.region
      description: Region for the session
    - contextPath: Autofocus.Sessions.sha256
      description: SHA256 of the file
    - contextPath: Autofocus.Sessions.tstamp
      description: Timestamp for session
    - contextPath: Autofocus.Sessions.upload_src
      description: Where did we get the file
    description: Search for sessions on Autofocus
  - name: autofocus-session
    arguments:
    - name: id
      required: true
      default: true
      description: The session ID to retrieve details for
    outputs:
    - contextPath: Autofocus.Sessions.id
      description: ID of the session
    - contextPath: Autofocus.Sessions.device_industry
      description: Device industry
    - contextPath: Autofocus.Sessions.filename
      description: The name of the file
    - contextPath: Autofocus.Sessions.region
      description: Region for the session
    - contextPath: Autofocus.Sessions.sha256
      description: SHA256 of the file
    - contextPath: Autofocus.Sessions.tstamp
      description: Timestamp for session
    - contextPath: Autofocus.Sessions.upload_src
      description: Where did we get the file
    description: Get details of a specific session
  - name: autofocus-sample-analysis
    arguments:
    - name: id
      required: true
      default: true
      description: The sample id
    - name: coverage
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Should we display coverage
      defaultValue: "true"
    - name: sections
      description: 'comma-separated list of sections to display: apk_app_icon, apk_app_name,
        apk_cert_file, apk_certificate_id, apk_defined_activity, apk_defined_intent_filter,
        apk_defined_receiver, apk_defined_sensor, apk_defined_service, apk_digital_signer,
        apk_embedded_library, apk_embeded_url, apk_internal_file, apk_isrepackaged,
        apk_packagename, apk_requested_permission, apk_sensitive_api_call, apk_suspicious_behavior,
        apk_suspicious_file, apk_suspicious_pattern, apk_suspicious_action_monitored,
        apk_suspicious_file, apk_suspicious_string, apk_version_num, behavior_type,
        connection, coverage, dns, file, http, japi, mac_embedded_url, misc, mutex,
        process, registry, service, user_agent'
      defaultValue: file
    - name: platforms
      description: 'comma-separated list of platforms: win7, winxp, android, staticAnalyzer,
        mac'
    description: Retrieve the sample analysis
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: Hash of the file to query. Supports MD5, SHA1 and SHA256.
    outputs:
    - contextPath: File.MD5
      description: File MD5 hash
    - contextPath: File.SHA1
      description: File SHA1 hash
    - contextPath: File.SHA256
      description: File SHA256 hash
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the Score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: DBotScore.Description
      description: The reason for the score (if any)
    description: Check file reputation of the given hash

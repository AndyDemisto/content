commonfields:
  id: RSA NetWitness Packets and Logs
  version: -1
name: RSA NetWitness Packets and Logs
display: RSA NetWitness Packets and Logs
category: Analytics & SIEM
image: data:image/png;base64,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
description: RSA NetWitness Logs and Packets decoders are responsible for the real-time
  collection of network data. The decode captures data in real time and can normalize
  and reconstruct data for full session analysis. In addition, the decoder can collect
  flow and endpoint data.
configuration:
- display: Appliance IP/Hostname (192.168.56.108)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Appliance Port - Logs(50102) / Packets(50104) / Concentrator (50105) /
    Broker (50103)
  name: port
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Secure (over HTTPS)
  name: secure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Expiration time
  name: expiry
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |-
    var RESPONSE_TYPES = {
        'json': 'application/json',
        'html': 'text/html',
        'text': 'text/plain',
        'xml': 'text/xml',
        'octet-stream': 'application/octet-stream'
    };

    var LAST_HOURS = 'lastHours';
    var LAST_MINUTES = 'lastMinutes';
    var QUERY = 'query';

    function fixUrl(base) {
        var url = base.trim();
        if (base.indexOf('http://') !== 0 && base.indexOf('https://') !== 0) {
            url = "http://" + url;
        }

        url = url.replace(/\/$/, '');

        return url;
    }

    var url = fixUrl(params.url) + ':' + params.port;

    function getUrl (currentUrl){
        var urlToReturn;
        if(args && args.concentratorAddress){
            urlToReturn = fixUrl(args.concentratorAddress);
            // Check if port was provided
            if(!urlToReturn.match(/:(\d.*)/)){
                urlToReturn += ":" + params.port;
            }
            delete(args.concentratorAddress);
        }
        else {
            urlToReturn = currentUrl;
        }

        return urlToReturn;
    }

    function isObjectEmpty (obj) {
        return Object.keys(obj).length === 0;
    }

    function mapQueryResults (fields, queryResults) {
        var TYPE  = 'type';
        var VALUE = 'value';
        var GROUP = 'group';
        if(fields && Array.isArray(fields)) {
            fields.forEach(function (element) {
                if (element[TYPE] && element[VALUE]) {
                    var index = element[GROUP];
                    if(!(queryResults[index])){
                        queryResults[index] = {};
                    }
                    if(!(queryResults[index][element[TYPE]])) {
                        queryResults[index][element[TYPE]] = [];
                    }
                    queryResults[index][element[TYPE]].push(element[VALUE]);
                }
            });
        }
    }

    function buildQueryMdAndContext (response) {
        //Check if we have values
        var data = parseResponse(response);
        var retVal = {md: [], context: {NetWitness:{}}};
        var queryResults = {};
        var extractFromData = function(data) {
            var fields = dq(data, 'results.fields');
            mapQueryResults(fields, queryResults);
        };

        if (Array.isArray(data)) {
            data.forEach(function (element) {
                extractFromData(element);
            });
        } else if ((typeof data) ==='object') {
            extractFromData(data);
        }

        var flatQueryResult = [];

        if(!isObjectEmpty(queryResults)) {
            for(key in queryResults) {
                flatQueryResult.push(queryResults[key])
            }

            retVal.md = flatQueryResult;
            retVal.context.NetWitness.Results = queryResults;
            var hr = tableToMarkdown(command, retVal.md);
            return {
                Type: entryTypes.note,
                Contents: data,
                ContentsFormat: formats.json,
                HumanReadable: hr,
                EntryContext: retVal.context,
                ReadableContentsFormat: formats.markdown
            };
        } else {
            return "No results found.";
        }
    }

    function buildNodeMdAndContext (response){
        var data = parseResponse(response);
        var nodes = data.nodes ? data.nodes : [data.node];

        return {
            Type: entryTypes.note,
            Contents: nodes,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown(command, nodes),
            EntryContext: {
                'NetWitness.Node(val.handle==obj.handle)' : nodes
            },
            ReadableContentsFormat: formats.markdown
        }
    }

    function buildStringMdAndContext (response){
        var data = parseResponse(response);
        var string = data.string;
        var md =  '### Results for ' + command + ':\n' + string;
        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: md
        }
    }

    function buildParamsMd (response){
        var data = parseResponse(response);
        var params = data.params;

        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown(command, params)
        }
    }

    function parseResponse (resp, isXml) {
        if (resp.StatusCode === 200) {
            try {
                var body = resp.Body;
                if(isXml){
                    body = x2j(body);
                }
                var res = JSON.parse(body);

                return res;
            } catch (e) {
                return body;
            }
        } else {
            err = resp.Status;
            if (resp.Body) {
                err += '\n' + resp.Body;
            }
            throw err;
        }
    }

    function parseDownloadResponse (resp) {
        if (resp.StatusCode === 200) {
            try {
                var currentTime = new Date();
                var fileName = command + '_at_' + currentTime.getTime();
                return {Type: 3, FileID: saveFile(resp.Bytes), File: fileName, Contents: fileName};
            } catch (e) {
                return e;
            }
        } else {
            err = resp.Status;
            if (resp.Body) {
                err += '\n' + resp.Body;
            }
            throw err;
        }
    }

    function getHelp(node) {
        var fullUrl = url + node + '?msg=help&op=messages' + '&force-content-type=application/json';
        res = http(
            fullUrl,
            {
                Method: 'GET',
                Username: params.credentials.identifier,
                Password: params.credentials.password
            },
            !params.secure,
            params.proxy
        );

        return parseResponse(res);
    }

    function handleTimeFilter(args) {
        if(LAST_HOURS in args || LAST_MINUTES in args) {
            var now = new Date();
            var dt = new Date();
            if (args[LAST_HOURS]) {
                dt.setHours(dt.getHours() - parseInt(args[LAST_HOURS]))
            }
            if (args[LAST_MINUTES]) {
                dt.setMinutes(dt.getMinutes() - parseInt(args[LAST_MINUTES]))
            }
            var buildDateFormat = function () {
                return dt.toISOString().slice(0,19).replace('T',' ') + '"-"' + now.toISOString().slice(0,19).replace('T',' ') + '"';
            };
            //if query is empry string
            if(!args || !args[QUERY]) {
                args[QUERY] = 'select * where time = "' + buildDateFormat();
            }
            //if query has select and where statements
            else if(args[QUERY] && args[QUERY].toLowerCase().indexOf('select') > -1 && args[QUERY].toLowerCase().indexOf('where') > -1) {
                args[QUERY] = args[QUERY] + ' && time = "' + buildDateFormat();
            }
            //id query contains just select
            else if(args[QUERY] && args[QUERY].toLowerCase().indexOf('select') > -1) {
                args[QUERY] = args[QUERY] + ' where time = "' + buildDateFormat();
            }
        }
    }

    function encodeParams(p) {
        var q = '';
        if (p) {
            var argsToIgnore = {
                responseType: true,
                using: true
            };
            handleTimeFilter(p);
            var keys = Object.keys(p);
            if (keys.length > 0) {
                q = '&';
                for (var i = 0; i < keys.length; i++) {
                    if (argsToIgnore[keys[i]]) {
                        continue;
                    } else if (i !== 0) {
                        q += '&';
                    }
                    q += encodeURIComponent(keys[i]) + '=' + encodeURIComponent(p[keys[i]]);
                }
            }
        }
        return q;
    }

    function doReq(method, path, args, resType, body) {
        var urlToUse = getUrl(url);
        var parametersUrl = encodeParams(args);
        var responseType = resType ? RESPONSE_TYPES[resType] : 'application/json';
        var fullUrl = urlToUse + path + parametersUrl + '&force-content-type=' + responseType;

        if (params.expiry) {
            fullUrl += '&expiry=' + params.expiry;
        }

        var res = http(
            fullUrl,
            {
                Method: method,
                Username: params.credentials.identifier,
                Password: params.credentials.password,
                Accept: responseType,
                Body: body || ''
            },
            !params.secure,
            params.proxy
        );

        if (res.StatusCode !== 200 && res.StatusCode !== 201) {
            throw 'Failed to perform request to: ' + fullUrl + '. StatusCode: ' + res.StatusCode + '. Error: ' + res.Body;
        }

        return res;
    }

    function decoderImport(path) {
        var fileParam = args.entryID ? args.entryID : args.fileID;
        var fullUrl = getUrl(url) + path;
        var res = httpMultipart(
            fullUrl,
            fileParam,
            { // HTTP Request Headers
                Method: 'POST',
                ContentType: 'appliaction/json',
                Accept: 'application/json',
                Username: params.credentials.identifier,
                Password: params.credentials.password
            },
            null,
            !params.secure,
            params.proxy
        );

        var data = parseResponse(res, true);

        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown(command, data.import.data)
        };

    }

    function parseBlob(response){
        var data = parseResponse(response);
        var blob = data.blob;

        var md =  '### Results for ' + command + ':\n' + blob;
        return {
            Type: entryTypes.note,
            Contents: blob,
            ContentsFormat: formats.json,
            HumanReadable: md
        };
    }

    function concentratorAgg() {
        var fullUrl = getUrl(url) + '/concentrator/agg';
        var body = {
            op: args.op,
            crc: args.crc,
            nice: args.nice
        };
        var res = http(
            fullUrl,
            { // HTTP Request Headers
                Method: 'POST',
                ContentType: 'appliaction/json',
                Accept: 'application/json',
                Username: params.credentials.identifier,
                Password: params.credentials.password,
                Body: JSON.stringify(body)
            },
            !params.secure,
            params.proxy
        );

        return parseResponse(res);
    }

    var commandToPath = {
        'netwitness-msearch': '/sdk?msg=msearch',
        'netwitness-search': '/sdk?msg=search',
        'netwitness-query': '/sdk?msg=query',
        'netwitness-packets': '/sdk/packets?',
        'nw-sdk-session': '/sdk?msg=session',
        'nw-sdk-cancel': '/sdk?msg=cancel',
        'nw-sdk-query': '/sdk?msg=query',
        'nw-sdk-validate': '/sdk?msg=validate',
        'nw-sdk-aliases': '/sdk?msg=aliases',
        'nw-sdk-content': '/sdk/?msg=content',
        'nw-sdk-ls': '/sdk?msg=ls',
        'nw-sdk-count': '/sdk?msg=count',
        'nw-sdk-timeline': '/sdk?msg=timeline',
        'nw-sdk-mon': '/sdk?msg=mon',
        'nw-sdk-stopMon': '/sdk?msg=stopMon',
        'nw-sdk-msearch': '/sdk?msg=msearch',
        'nw-sdk-precache': '/sdk?msg=precache',
        'nw-sdk-delCache': '/sdk?msg=delCache',
        'nw-sdk-info': '/sdk?msg=info',
        'nw-sdk-search': '/sdk?msg=search',
        'nw-sdk-language': '/sdk?msg=language',
        'nw-sdk-packets': '/sdk?msg=packets',
        'nw-sdk-summary': '/sdk?msg=summary',
        'nw-sdk-reconfig': '/sdk?msg=reconfig',
        'nw-sdk-values': '/sdk?msg=values',
        'nw-sdk-xforms': '/sdk?msg=xforms',
        'nw-database-info': '/database?msg=info',
        'nw-database-count': '/database?msg=count',
        'nw-database-dbState': '/database?msg=dbState',
        'nw-database-dump': '/database?msg=dump',
        'nw-database-hashnw-loInfo': '/database?msg=hashInfo',
        'nw-database-resetMax': '/database?msg=resetMax',
        'nw-database-optimize': '/database?msg=optimize',
        'nw-database-reconfig': '/database?msg=reconfig',
        'nw-database-ls': '/database?msg=ls',
        'nw-database-timeRoll': '/database?msg=timeRoll',
        'nw-database-stopMon': '/database?msg=stopMon',
        'nw-database-manifest': '/database?msg=manifest',
        'nw-database-wipe': '/database?msg=wipe',
        'nw-database-sizeRoll': '/database?msg=sizeRoll',
        'nw-database-mon': '/database?msg=mon',
        'nw-decoder-reset': '/decoder?msg=reset',
        'nw-decoder-info': '/decoder?msg=info',
        'nw-decoder-reconfig': '/decoder?msg=reconfig',
        'nw-decoder-agg': '/decoder?msg=agg',
        'nw-decoder-stop': '/decoder?msg=stop',
        'nw-decoder-count': '/decoder?msg=count',
        'nw-decoder-start': '/decoder?msg=start',
        'nw-decoder-meta': '/decoder?msg=meta',
        'nw-decoder-ls': '/decoder?msg=ls',
        'nw-decoder-stopMon': '/decoder?msg=stopMon',
        'nw-decoder-resetMax': '/decoder?msg=resetMax',
        'nw-decoder-whoAgg': '/decoder?msg=whoAgg',
        'nw-decoder-logStats': '/decoder?msg=logStats',
        'nw-decoder-select': '/decoder?msg=select',
        'nw-decoder-mon': '/decoder?msg=mon',
        'nw-index-ls': '/index?msg=ls',
        'nw-index-mon': '/index?msg=mon',
        'nw-index-save': '/index?msg=save',
        'nw-index-info': '/index?msg=info',
        'nw-index-drop': '/index?msg=drop',
        'nw-index-count': '/index?msg=count',
        'nw-index-values': '/index?msg=values',
        'nw-index-profile': '/index?msg=profile',
        'nw-index-stopMon': '/index?msg=stopMon',
        'nw-index-inspect': '/index?msg=inspect',
        'nw-index-language': '/index?msg=language',
        'nw-index-reconfig': '/index?msg=reconfig',
        'nw-index-sizeRoll': '/index?msg=sizeRoll',
        'nw-decoderParsers-ls': '/decoder/parsers?msg=ls',
        'nw-decoderParsers-mon': '/decoder/parsers?msg=mon',
        'nw-decoderParsers-feed': '/decoder/parsers?msg=feed',
        'nw-decoderParsers-info': '/decoder/parsers?msg=info',
        'nw-decoderParsers-count': '/decoder/parsers?msg=count',
        'nw-decoderParsers-schema': '/decoder/parsers?msg=schema',
        'nw-decoderParsers-reload': '/decoder/parsers?msg=reload',
        'nw-decoderParsers-upload': '/decoder/parsers?msg=upload',
        'nw-decoderParsers-delete': '/decoder/parsers?msg=delete',
        'nw-decoderParsers-stopMon': '/decoder/parsers?msg=stopMon',
        'nw-decoderParsers-devices': '/decoder/parsers?msg=devices',
        'nw-decoderParsers-content': '/decoder/parsers?msg=content',
        'nw-decoderParsers-ipdevice': '/decoder/parsers?msg=ipdevice',
        'nw-decoderParsers-iptmzone': '/decoder/parsers?msg=iptmzone',
        'nw-logs-ls': '/logs?msg=ls',
        'nw-logs-mon': '/logs?msg=mon',
        'nw-logs-pull': '/logs?msg=pull',
        'nw-logs-info': '/logs?msg=info',
        'nw-logs-count': '/logs?msg=count',
        'nw-logs-stopMon': '/logs?msg=stopMon',
        'nw-logs-download': '/logs?msg=download',
        'nw-logs-timeRoll': '/logs?msg=timeRoll',
        'nw-sys-ls': '/sys?msg=ls',
        'nw-sys-mon': '/sys?msg=mon',
        'nw-sys-save': '/sys?msg=save',
        'nw-sys-info': '/sys?msg=info',
        'nw-sys-count': '/sys?msg=count',
        'nw-sys-caCert': '/sys?msg=caCert',
        'nw-sys-stopMon': '/sys?msg=stopMon',
        'nw-sys-shutdown': '/sys?msg=shutdown',
        'nw-sys-fileEdit': '/sys?msg=fileEdit',
        'nw-sys-peerCert': '/sys?msg=peerCert',
        'nw-sys-servCert': '/sys?msg=servCert',
        'nw-sys-statHist': '/sys?msg=statHist',
        'nw-users-ls': '/users?msg=ls',
        'nw-users-mon': '/users?msg=mon',
        'nw-users-info': '/users?msg=info',
        'nw-users-auths': '/users?msg=auths',
        'nw-users-count': '/users?msg=count',
        'nw-users-delete': '/users?msg=delete',
        'nw-users-unlock': '/users?msg=unlock',
        'nw-users-stopMon': '/users?msg=stopMon',
        'nw-users-addOrMod': '/users?msg=addOrMod',
        'nw-concentrator-ls': '/concentrator?msg=ls',
        'nw-concentrator-add': '/concentrator?msg=add',
        'nw-concentrator-mon': '/concentrator?msg=mon',
        'nw-concentrator-meta': '/concentrator?msg=meta',
        'nw-concentrator-info': '/concentrator?msg=info',
        'nw-concentrator-help': '/concentrator?msg=help',
        'nw-concentrator-stop': '/concentrator?msg=stop',
        'nw-concentrator-edit': '/concentrator?msg=edit',
        'nw-concentrator-reset': '/concentrator?msg=reset',
        'nw-concentrator-count': '/concentrator?msg=count',
        'nw-concentrator-start': '/concentrator?msg=start',
        'nw-concentrator-delete': '/concentrator?msg=delete',
        'nw-concentrator-whoAgg': '/concentrator?msg=whoAgg',
        'nw-concentrator-status': '/concentrator?msg=status',
        'nw-concentrator-stopMon': '/concentrator?msg=stopMon',
        'nw-concentrator-reconfig': '/concentrator?msg=reconfig',
        'nw-concentrator-resetMax': '/concentrator?msg=resetMax',
        'nw-broker-ls': '/broker?msg=ls',
        'nw-broker-add': '/broker?msg=add',
        'nw-broker-mon': '/broker?msg=mon',
        'nw-broker-meta': '/broker?msg=meta',
        'nw-broker-info': '/broker?msg=info',
        'nw-broker-help': '/broker?msg=help',
        'nw-broker-stop': '/broker?msg=stop',
        'nw-broker-edit': '/broker?msg=edit',
        'nw-broker-reset': '/broker?msg=reset',
        'nw-broker-count': '/broker?msg=count',
        'nw-broker-start': '/broker?msg=start',
        'nw-broker-delete': '/broker?msg=delete',
        'nw-broker-whoAgg': '/broker?msg=whoAgg',
        'nw-broker-status': '/broker?msg=status',
        'nw-broker-stopMon': '/broker?msg=stopMon',
        'nw-broker-reconfig': '/broker?msg=reconfig',
        'nw-broker-resetMax': '/broker?msg=resetMax'
    };


    // The command input arg holds the command sent from the user.
    switch (command) {
        // This is the call made when pressing the integration test button.
        case 'test-module':
            doReq('GET', '/sdk?msg=help&op=messages');
            return true;
        case 'nw-decoder-import':
            return decoderImport('/decoder/import');
        case 'netwitness-packets':
            return parseDownloadResponse(doReq('GET', commandToPath[command], args, args.responseType));
        case 'netwitness-msearch':
        case 'netwitness-search':
        case 'netwitness-query':
        case 'nw-sdk-language':
        case 'nw-sdk-timeline':
        case 'nw-sdk-values':
            return buildQueryMdAndContext(doReq('GET', commandToPath[command], args, args.responseType));
        case 'nw-sdk-content':
            return parseBlob(doReq('GET', commandToPath[command], args, args.responseType));
        case 'nw-sdk-info':
        case 'nw-sdk-ls':
        case 'nw-broker-ls':
        case 'nw-concentrator-ls':
        case 'nw-database-info':
        case 'nw-database-ls':
        case 'nw-decoder-info':
        case 'nw-decoder-ls':
        case 'nw-decoderParsers-info':
        case 'nw-decoderParsers-ls':
        case 'nw-index-info':
        case 'nw-index-ls':
        case 'nw-logs-info':
        case 'nw-logs-ls':
        case 'nw-sys-info':
        case 'nw-sys-ls':
        case 'nw-users-info':
        case 'nw-users-ls':
            return buildNodeMdAndContext(doReq('GET', commandToPath[command], args, args.responseType));
        case 'nw-decoderParsers-ipdevice':
        case 'nw-sdk-validate':
        case 'nw-users-unlock':
        case 'nw-sdk-summary':
            return buildStringMdAndContext(doReq('GET', commandToPath[command], args, args.responseType));
        case 'nw-sdk-session':
        case 'nw-logs-pull':
        case 'nw-decoder-logStats':
            return buildParamsMd(doReq('GET', commandToPath[command], args, args.responseType));
        default:
            return parseResponse(doReq('GET', commandToPath[command], args, args.responseType));
    }
  type: javascript
  commands:
  - name: netwitness-msearch
    arguments:
    - name: sessions
      description: <string, optional> The session ID ranges to search
    - name: packets
      description: <string, optional> The packet ID ranges to search
    - name: search
      required: true
      description: '<string> The search string to use. Example: "select hit, pretext,
        posttext where keyword=’netwitness’ sp ci ds". sp = Search Packets ci = Case
        Insensitive ds = Decode Sessions (e.g., convert email attachments before searching).
        For regular expressions, change “keyword” to “regex” '
    - name: where
      description: <string, optional> The where clause used to identify sessions to
        consider for the search
    - name: limit
      description: <uint64, optional> The maximum number of sessions to traverse for
        this search
    - name: flags
      description: <string, optional> Flags to use for search.  This is a comma separated
        list of one or more of the flag values regex, sp, sm, si, ci, pre, post, ds
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Events
      description: all events of netwitness
    description: Search for pattern matches in many sessions or packets
  - name: netwitness-search
    arguments:
    - name: session
      required: true
      description: <uint64> The session id to search
    - name: size
      required: true
      description: <uint32, {range:1 to 1677721}> The max number of entries to return
    - name: search
      required: true
      description: <string> The search string to use
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Events
      description: all events of netwitness
    description: Searches for matches in session/packet content
  - name: netwitness-query
    arguments:
    - name: id1
      description: <uint64, optional> The starting meta id (to run the query from
        most recent to oldest meta, make id1 larger than id2)
    - name: id2
      description: <uint64, optional> The ending meta id
    - name: size
      description: <uint32, optional> The max number of entries to return, or just
        stream back all results if zero
    - name: query
      description: <string, optional> The query string to use
    - name: flags
      description: <string, optional> The flags to use for query.  Can be a number
        (bitwise mask) or comma separated values like query-log.
    - name: threshold
      description: <uint64, optional> Query optimization to stop processing results
        after the threshold is reached (useful with select aggregate functions).  Zero
        means no threshold (the default).
    - name: lastHours
      description: <uint64, optional> Filter for date and time
    - name: lastMinutes
      description: <uint64, optional> Filter by last minutes
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Events
      description: all events of NetWitness
    description: Performs a query against the meta database
  - name: netwitness-packets
    arguments:
    - name: op
      description: <string, {enum-one:start|cancel|processed}> The operation to perform
        (start, cancel, processed)
    - name: sessions
      required: true
      description: <string, optional> A comma separated list of session ids or session
        id ranges (#-#) whose packets will be streamed back.
    - name: packets
      description: <string, optional> A comma separated list of packet ids or session/packet
        ids (#&#) that will be streamed back.
    - name: where
      description: <string, optional> Where clause which will be evaluated to determine
        which sessions to stream back
    - name: time1
      description: <date-time, optional> A starting time range (UTC) where matching
        packets will be streamed back ("2010-Apr-20 09:00:00")
    - name: time2
      description: <date-time, optional> An ending time range (UTC) where matching
        packets will be streamed back ("2010-Apr-20 10:00:00")
    - name: flags
      description: <uint32, optional> Additional flags as defined by the NwPackets
        SDK function
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Events
      description: all events of NetWitness
    description: Stream packets back based on the input parameters provided
  - name: nw-sdk-session
    arguments:
    - name: id1
      required: true
      description: <uint64> The starting session id
    - name: id2
      required: true
      description: <uint64> The ending session id
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Retrieves the meta id range for the session range
  - name: nw-sdk-validate
    arguments:
    - name: op
      required: true
      description: <string, {enum-one:query|values}> The operation to validate
    - name: validateLanguage
      description: <bool, optional> If true (default is false), language tokens and
        syntax will be validated, otherwise just syntax will be validated
    - name: fieldName
      description: <string, optional> Required if validating a 'values' operation.
        The field to retrieve values for.
    - name: where
      description: <string, optional> Optional if validating a 'values' operation.
        The filter criteria to be validated.
    - name: query
      description: <string, optional> Required if validating a 'query' operation.
        The query string to be validated.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Validate a query or values call without execution
  - name: nw-sdk-content
    arguments:
    - name: session
      required: true
      description: <uint64> The session id to retrieve packet content for
    - name: packet
      description: <uint64, optional> The packet id of the first packet of the session,
        in case the session has rolled out
    - name: maxSize
      description: <size, optional> The max number of bytes to return, zero means
        no limit
    - name: failOnCacheMiss
      description: <bool, optional> If true, the content call fails if the NWD is
        not in the cache.  This is used by optimized caching code only.
    - name: renderType
      description: <uint32, optional> The render type (see NwContentTypes in NwSDK.h),
        pass zero to pick best option.  Not specifying this parameter always results
        in an NWD and renderFlags and renderOptions are not considered.
    - name: renderFlags
      description: <uint32, optional> Bitwise mask to control options, (see NwContentFlags
        in NwSDK.h)
    - name: renderOptions
      description: <string, optional> An encoded string params containing additional
        options for controlling the operation.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Returns the packet content for a session
  - name: nw-sdk-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-sdk-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-sdk-timeline
    arguments:
    - name: time1
      description: <date-time, optional> The starting time in seconds since 1970 or
        a time string (YYYY-MMM-DD HH:MM:SS), if greater than time2, then the whole
        time range is returned
    - name: time2
      description: <date-time, optional> The ending time in seconds since 1970 or
        a time string (YYYY-MMM-DD HH:MM:SS)
    - name: timezone
      description: <int32, optional> The timezone of the local computer to receive
        the data, hour offset from GMT [-13 to 13]
    - name: size
      required: true
      description: <uint32, {range:1 to 1677721}> The max number of entries to return
    - name: flags
      description: <string, optional> The flags to use for the timeline.  Can be a
        number (bitwise mask) or comma separated values like sessions, size, packets,
        order-ascending, order-descending, ignore-cache or clear-cache.
    - name: where
      description: <string, optional> Optional where clause for filtering the data
    - name: bookendHours
      description: uint32, optional> The number of hours outside the given time1,
        time2 which will become part of the cache.  Default is 24 hours.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Returns the count of sessions/size/packets in discrete time intervals
  - name: nw-sdk-summary
    arguments:
    - name: flags
      description: <string, optional> Optional SDK flags.  Can be a number (bitwise
        mask) or comma separated values like default or ignore-cache.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Retrieves summary information from the databases
  - name: nw-sdk-values
    arguments:
    - name: id1
      description: <uint64, optional> The starting meta id
    - name: id2
      description: <uint64, optional> The ending meta id
    - name: size
      required: true
      description: <uint32, {range:1 to 1677721}> The max number of entries to return
    - name: flags
      description: <string, optional> The flags to use for values.  Can be a number
        (bitwise mask) or comma separated values like sessions, size, packets, aggregate,
        sort-total, sort-value, order-ascending, order-descending, ignore-cache, clear-cache,
        query-log or database-scan.
    - name: threshold
      description: <uint64, optional> Query optimization to stop processing large
        session counts
    - name: fieldName
      required: true
      description: <string> The field to retrieve values for
    - name: where
      description: <string, optional> The filter criteria for the values
    - name: aggregateFunction
      description: <string, optional, {enum-one:count|sum}> The aggregate operation
        to be applied where the aggregate flag is set
    - name: aggregateFieldName
      description: <string, optional> The meta field to aggregate in the aggregateFunction
    - name: min
      description: <string, optional> The lower limit of values to return.  Only values
        greater than this value will be returned.
    - name: max
      description: <string, optional> The upper limit of values to return.  Only values
        less than this value will be returned.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Performs a value count query and returns the matching values for
      a report
  - name: nw-database-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-database-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-decoder-info
    arguments:
    - name: update
      description: <bool, optional> If true (default is false), will automatically
        update the respective decoder settings, otherwise it will just output the
        calculations
    - name: op
      description: <string, optional, {enum-one:normal|10g}> The operating mode, 'normal'
        or '10g'. Default is normal.
    - name: memory
      description: <size, optional> If non-zero, will use that setting as installed
        physical RAM (e.g., memory="24 GiB"). This is useful for hybrids and/or all-in-one
        machines where the service will need to share memory.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-decoder-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-decoder-logStats
    arguments:
    - name: op
      description: <string, optional, {enum-one:clear|remove|save}> The log stats
        operation.  If clear, all log stats state will be reset and no results will
        be returned. If save, the current stats are saved for the next time the log
        decoder is restarted.
    - name: deviceFilter
      description: <string, optional> A regex that will only return matching devices.
    - name: forwarderFilter
      description: <string, optional> A regex that will only return matching forwarders.
    - name: sourceFilter
      description: <string, optional> A regex that will only return matching sources.
    - name: timeFilter
      description: <string, optional> This parameter forms a window from the current
        time which will return any device that falls outside that window.  So if you
        pass 300, it will return all devices that have not sent a log in over 5 minutes.  You
        can pass a hard datetime (YYYY-MM-DD HH:MM:SS) or a time duration (HH:MM:SS
        or just number of seconds). Not compatible with the lastReceived parameter.
    - name: lastReceived
      description: <string, optional> Compare the last received log time from each
        device with the passed in operator (<, <=, >, >=) and time/duration. For example,
        lastReceived="<60" will return all devices that have sent logs less than 60
        seconds ago. lastReceived=">=2014-04-23 16:00:00" will return all devices
        that have sent logs on or after April 4, 2014 at 4pm UTC.
    - name: lastUpdated
      description: <string, optional> Compare the last updated log time from each
        device with the passed in operator (<, <=, >, >=) and time/duration. For example,
        lastUpdated="<60" will return all devices that have had logs updated less
        than 60 seconds ago. lastUpdated=">=2014-04-23 16:00:00" will return all devices
        that have had logs updated on or after April 4, 2014 at 4pm UTC.
    - name: timeFormat
      description: <string, optional, {enum-one:posix|simple}> Specify the time format
        that is returned (posix, simple), default is simple (YYYY-MM-DD HH:MM:SS)
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Retrieve count and last receive times for log devices, sources and
      forwarders.
  - name: nw-index-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-index-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-decoderParsers-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-decoderParsers-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-decoderParsers-ipdevice
    arguments:
    - name: op
      required: true
      description: <string, {enum-one:edit|describe}> The operation to perform (edit|describe).
    - name: entries
      description: <string, optional> The IP entries. StringParam in format of '+/-ip=device'.
        + means adding or editing a map entry, - means delete a map entry
    - name: reload
      description: <bool, optional> If true, reload parsers when command finishes.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Map IP to Device type in log parsing. Takes effect after parser reload.
  - name: nw-logs-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-logs-pull
    arguments:
    - name: d1
      description: <uint64, optional> The first log id number to retrieve, this is
        mutually exclusive with id2
    - name: id2
      description: <uint64, optional> The last log id number that will be sent, defaults
        to most recent log message when id1 or id2 is not sent
    - name: count
      description: <uint32, optional, {range:1 to 10000}> The number of logs to pull
    - name: timeFormat
      description: <string, optional, {enum-one:posix|simple}> The time format used
        in each log message, default is posix time (seconds since 1970)
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Downloads N log entries
  - name: nw-logs-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-sys-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-sys-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Returns detailed information about the node
  - name: nw-users-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns the list of child nodes
  - name: nw-users-info
    arguments:
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: Returns detailed information about the node
  - name: nw-decoder-import
    arguments:
    - name: entryID
      description: The entry IF of file from the War Room.
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    description: Import new data into the decoder
  - name: nw-concentrator-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: 'Returns the list of child nodes security.roles: everyone'
  - name: nw-broker-ls
    arguments:
    - name: depth
      description: <uint32, optional> How many levels deep to return node info, default
        is 1
    - name: options
      description: <string, optional> What types of nodes to return information about,
        default is all nodes.  Can be a number (bitwise mask) or comma separated values
        like config, stat, folder, session, connection, channel, restart-needed or
        pretty-print.
    - name: exclude
      description: '<string, optional> Comma separated list of nodes or node pathnames
        to exclude (wildcards allowed: * and ?)'
    - name: concentratorAddress
      description: Use the instance that is mapped to this concentrator address
    outputs:
    - contextPath: NetWitness.Node.display
      description: Node display
    - contextPath: NetWitness.Node.handle
      description: Node handle
    - contextPath: NetWitness.Node.name
      description: Node name
    - contextPath: NetWitness.Node.nodeType
      description: Node type
    - contextPath: NetWitness.Node.parentHandle
      description: Node parent handle
    - contextPath: NetWitness.Node.path
      description: Node path
    description: 'Returns the list of child nodes security.roles: everyone'
fromversion: 3.5.0
releaseNotes: "-"

commonfields:
  id: Farsight DNSDB
  version: -1
name: Farsight DNSDB
display: Farsight DNSDB
category: Data Enrichment
image: data:image/png;base64,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
description: Query Farsight DNSDB service
configuration:
- display: API Key
  name: apiKey
  defaultvalue: ""
  type: 0
  required: true
- display: DNSDB Service URL
  name: url
  defaultvalue: https://api.dnsdb.info/
  type: 0
  required: true
script:
  script: |
    var serverUrl = params.url;
    if (serverUrl[serverUrl.length - 1] !== '/') {
        serverUrl += '/';
    }

    var dict = {
        rdata: {
            url: 'lookup/rdata/',
            defaultLimit:100,
            tableColumns: {
                rrname:'',
                rrtype:'',
                rdata:'',
                count:'',
                time_first:'ts',
                time_last:'ts',
                zone_time_first:'ts',
                zone_time_last:'ts'
            }
        },
        rrset: {
            url: 'lookup/rrset/name/',
            defaultLimit:100,
            tableColumns: {
                rrname:'',
                rrtype:'',
                rdata:'',
                bailiwick:'',
                count:'',
                time_first:'ts',
                time_last:'ts',
                zone_time_first:'ts',
                zone_time_last:'ts'
            }

        }
    }
    var valueExist = function(data,key) {
        var array = (Array.isArray(data)) ? data : [data];

        for (var i=0;i<array.length;i++) {
            if (array[i][key]) {
                return true;
            }
        }
        return false;

    }

    var tsToTime = function(ts) {
        if (ts) {
            var date = new Date(ts*1000);
            var hours = date.getHours();
            var minutes = "0" + date.getMinutes();
            var seconds = "0" + date.getSeconds();
            var formattedTime = date + ' ' + hours + ':' + minutes.substr(-2) + ':' + seconds.substr(-2);
            return formattedTime;
        } else {
            return '';
        }
    }

    var arrToNewLines = function (data) {
        var md='';
        if (Array.isArray(data)) {
            for (var i=0;i<data.length;i++) {
                md += data[i] + '<br>';
            }

        } else {
            md=data;
        }
        return md;
    }

    var dataToMd = function (api,data) {
        var keys={};
        for (key in dict[api].tableColumns) {
            if (valueExist(data,key)) {
                keys[key]=dict[api].tableColumns[key];
            }
        }
        var head='|';
        var line='-';
        for (key in keys) {
            head+=key+'|';
            line+='-|';
        }
        var md=head+'\n'+line+'\n';
        for (var i = 0; i<data.length; i++) {
            md += '|';
            for (key in keys) {
                if (keys[key] == 'ts') {
                    md += tsToTime(data[i][key])+'|';
                } else {
                    md += arrToNewLines(data[i][key]) + '|';
                }
            }
            md += '\n';
        }
        return md;
    }

    var sendRequest = function(requestUrl,parameters) {
        var url = serverUrl + requestUrl + encodeToURLQuery(parameters);
        console.log(url);
        var res = http(
            url,
            {
                Method: 'GET', // Can be POST, PUT, DELETE, HEAD, OPTIONS or CONNECT
                Headers: {
                    'Accept': ['application/json'],
                    'X-API-Key': [params.apiKey]
                }
            }
        );
        if (res.StatusCode < 200 || res.StatusCode>299) {
            throw 'Error ' + res.StatusCode + '. ' + res.Status;
        }
        var obj={};
        obj.entries=[];
        var array = res.Body.split('\n');
        for (var i=0;i<array.length;i++) {
            console.log('parsing ' + array[i]);
            if (array[i] && array[i].length > 0) {
                try {
                    obj.entries.push(JSON.parse(array[i]));
                } catch (err) {

                }
            }
        }
        return obj;
    };

    var lookupRequest = function(api,requestUrl) {
        var parameters={};
        parameters.limit = (args.limit) ? args.limit : dict[api].defaultLimit;

        if (args.time_first_before) {
            parameters.time_first_before = args.time_first_before*-1;
        }
        if (args.time_first_after) {
            parameters.time_first_after = args.time_first_after*-1;
        }
        if (args.time_last_before) {
            parameters.time_last_before = args.time_last_before*-1;
        }
        if (args.time_last_after) {
            parameters.time_last_after = args.time_last_after*-1;
        }
        var res= sendRequest(requestUrl,parameters);
        var md = dataToMd(api,res.entries);
        return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
    }

    // The command input arg holds the command sent from the user.
    switch (command) {
        // This is the call made when pressing the integration test button.
        case 'test-module':
            res = sendRequest(urlDict.limit);
            return 'ok';
        case 'dnsdb-rdata':
            // /lookup/rdata/TYPE/VALUE/RRTYPE
            var requestUrl = dict.rdata.url + args.type + '/' + args.value;
            requestUrl += (args.rrtype) ? '/' + args.rrtype : '';
            return lookupRequest('rdata',requestUrl);
        case 'dnsdb-rrset':
            // /lookup/rrset/name/OWNER_NAME/RRTYPE/BAILIWICK
            var requestUrl = dict.rrset.url + args.owner;
            requestUrl += (args.rrtype) ? '/' + args.rrtype : '';
            requestUrl += (args.bailiwick) ? '/' + args.bailiwick : '';
            return lookupRequest('rrset',requestUrl);
        default:
            throw 'Unknown command ' + command;
    }
  type: javascript
  commands:
  - name: dnsdb-rdata
    arguments:
    - name: type
      required: true
      auto: PREDEFINED
      predefined:
      - name
      - ip
      - raw
      description: query type
    - name: value
      required: true
      description: query value
    - name: limit
      description: Limit the number of returned records
      defaultValue: "100"
    - name: time_first_before
      description: Filter results for entries seen for first time before (seconds)
    - name: time_last_before
      description: Filter results for entries seen last time before (seconds)
    - name: time_first_after
      description: filter results for entries seen first time after (seconds)
    - name: time_last_after
      description: filter results for entries seen last time after (seconds)
    - name: rrtype
      description: query rrtype
    description: Lookup rdata records
  - name: dnsdb-rrset
    arguments:
    - name: owner
      required: true
      description: Owner name to query
    - name: rrtype
      description: rrtype value to query
    - name: bailiwick
      description: Bailiwick value to query
    - name: limit
      description: Limit the number of returned records
      defaultValue: "100"
    - name: time_first_before
      description: Filter results for entries seen for first time before (seconds)
    - name: time_first_after
      description: Filter results for entries seen for first time after (seconds)
    - name: time_last_before
      description: Filter results for entries seen for last time before (seconds)
    - name: time_last_after
      description: Filter results for entries seen for last time after (seconds)
    description: Lookup rrser records
hidden: false

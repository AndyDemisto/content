id: McAfeeESMTest
version: 30
name: McAfeeESMTest
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: cb6d12e3-3d1a-4bd3-82a6-ee3f178f2c99
    type: start
    task:
      id: cb6d12e3-3d1a-4bd3-82a6-ee3f178f2c99
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
  "2":
    id: "2"
    taskid: 81a8ce2a-ff6f-473d-8ae7-a0664880083c
    type: regular
    task:
      id: 81a8ce2a-ff6f-473d-8ae7-a0664880083c
      version: -1
      name: esm-add-case
      description: Add a case to the system
      script: McAfee ESM-v10|||esm-add-case
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      assignee: ""
      organization: ""
      severity: ""
      status: ""
      summary: this is the first case
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
  "4":
    id: "4"
    taskid: 99e0951f-c7ff-42be-864d-e3cd8a12e787
    type: regular
    task:
      id: 99e0951f-c7ff-42be-864d-e3cd8a12e787
      version: -1
      name: Clear Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      additional: ""
      all: "yes"
      contextKey: ""
      data: ""
      filter: ""
      filterType: ""
      key: ""
      out: ""
      table: ""
      title: ""
      verbose: ""
      xml: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "5":
    id: "5"
    taskid: d028d4d5-e367-4146-89e1-9109ef92c71e
    type: regular
    task:
      id: d028d4d5-e367-4146-89e1-9109ef92c71e
      version: -1
      name: Verify case added to context
      scriptName: VerifyContextFields
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      field1: Case.ID
      field2: Case.Summary
      field3: Case.Status
      field4: Case.Assignee
      value1: ${Case.ID}
      value2: ${Case.Summary}
      value3: ${Case.Status}
      value4: ${Case.Assignee}
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
  "6":
    id: "6"
    taskid: 5ab9d107-5a97-427d-8560-8a5b094d6ad8
    type: regular
    task:
      id: 5ab9d107-5a97-427d-8560-8a5b094d6ad8
      version: -1
      name: Edit severity, organization and summary
      script: McAfee ESM-v10|||esm-edit-case
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      assignedUser: ""
      assignee: ""
      customEnd: ""
      customStart: ""
      filters: ""
      id: ${Case.ID}
      maxWait: ""
      organization: LuthorCorp
      queryType: ""
      severity: "50"
      status: ""
      summary: editing first case
      timeRange: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
  "7":
    id: "7"
    taskid: bfa8b519-2c9a-4b0c-8607-68f6b08fb39e
    type: regular
    task:
      id: bfa8b519-2c9a-4b0c-8607-68f6b08fb39e
      version: -1
      name: Validate case edit
      scriptName: VerifyContextFields
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      field1: Case.ID
      field2: Case.Assignee
      field3: Case.OpenTime
      field4: Case.EventList
      value1: ${Case.ID}
      value2: ${Case.Assignee}
      value3: ${Case.OpenTime}
      value4: ${Case.EventList}
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
  "9":
    id: "9"
    taskid: 782f40da-cf5a-46bb-8f00-8e8f899c6556
    type: regular
    task:
      id: 782f40da-cf5a-46bb-8f00-8e8f899c6556
      version: -1
      name: Get case info after event assignment
      script: McAfee ESM-v10|||esm-get-case-detail
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      field1: ""
      field2: ""
      field3: ""
      field4: ""
      id: ${Case.ID}
      value1: ""
      value2: ""
      value3: ""
      value4: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
  "11":
    id: "11"
    taskid: 7ef9c2ba-b718-4a58-8b75-b32e6791d362
    type: regular
    task:
      id: 7ef9c2ba-b718-4a58-8b75-b32e6791d362
      version: -1
      name: Add new case with all parameters.
      script: McAfee ESM-v10|||esm-add-case
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      assignee: JKRolling
      organization: LuthorCorp
      severity: "1"
      status: Research
      summary: McAfee ESM playbook test - all parameter case
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
  "13":
    id: "13"
    taskid: 65569abb-562b-49d0-80f7-fa4ba6a5232c
    type: regular
    task:
      id: 65569abb-562b-49d0-80f7-fa4ba6a5232c
      version: -1
      name: Edit the user name of last case to default
      script: McAfee ESM-v10|||esm-edit-case
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      assignee: me
      id: ${Case.ID}
      organization: ""
      severity: ""
      status: Open
      summary: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
  "14":
    id: "14"
    taskid: 35b01f65-88ad-44c3-82e7-aa70a4b56eee
    type: regular
    task:
      id: 35b01f65-88ad-44c3-82e7-aa70a4b56eee
      version: -1
      name: Clear the context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      all: "yes"
      key: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
  "15":
    id: "15"
    taskid: f92a85ce-ebd9-481c-8739-db50ab324c44
    type: regular
    task:
      id: f92a85ce-ebd9-481c-8739-db50ab324c44
      version: -1
      name: Add a new case status named "Research"
      script: McAfee ESM-v10|||esm-add-case-status
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      name: Research
      show_in_case_pane: "True"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
  "16":
    id: "16"
    taskid: ab1d8a2e-7ad5-4b95-82de-8a9424ee419c
    type: regular
    task:
      id: ab1d8a2e-7ad5-4b95-82de-8a9424ee419c
      version: -1
      name: Change case status name from "Research" to "Development"
      script: McAfee ESM-v10|||esm-edit-case-status
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      new_name: Development
      original_name: Research
      show_in_case_pane: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
  "17":
    id: "17"
    taskid: b462a33f-3d45-4725-86bb-c526dc97c724
    type: regular
    task:
      id: b462a33f-3d45-4725-86bb-c526dc97c724
      version: -1
      name: Remove additional case status
      script: McAfee ESM-v10|||esm-delete-case-status
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      name: Development
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
  "18":
    id: "18"
    taskid: 9be1a60a-dcd6-4bfe-80f9-79f5de3e8eff
    type: regular
    task:
      id: 9be1a60a-dcd6-4bfe-80f9-79f5de3e8eff
      version: -1
      name: Set show case pane of new case status
      script: McAfee ESM-v10|||esm-add-case-status
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      name: VooDoo
      show_in_case_pane: "True"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
  "19":
    id: "19"
    taskid: 2df25d48-42e3-4b9a-8059-6b509c588336
    type: regular
    task:
      id: 2df25d48-42e3-4b9a-8059-6b509c588336
      version: -1
      name: Change case status optional parameter
      script: McAfee ESM-v10|||esm-edit-case-status
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      new_name: VooDoo
      original_name: VooDoo
      show_in_case_pane: "False"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
  "20":
    id: "20"
    taskid: f2174c42-dd52-4259-814a-a37d8d5242c4
    type: regular
    task:
      id: f2174c42-dd52-4259-814a-a37d8d5242c4
      version: -1
      name: Remove additional case status2
      script: McAfee ESM-v10|||esm-delete-case-status
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      name: VooDoo
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
  "21":
    id: "21"
    taskid: d52a1f32-784d-4735-808d-15c02a43838d
    type: regular
    task:
      id: d52a1f32-784d-4735-808d-15c02a43838d
      version: -1
      name: Fetch Alarms
      script: McAfee ESM-v10|||esm-fetch-alarms
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      assignedUser: ME
      customEnd: ""
      customStart: ""
      filters: ""
      maxWait: ""
      queryType: ""
      timeRange: CURRENT_WEEK
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3490
        }
      }
  "22":
    id: "22"
    taskid: e4b1b9de-d3a1-4a05-8827-155a9e57f447
    type: title
    task:
      id: e4b1b9de-d3a1-4a05-8827-155a9e57f447
      version: -1
      name: All listing commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
  "23":
    id: "23"
    taskid: 74bc8a77-bba7-4635-87b0-042283ed865c
    type: regular
    task:
      id: 74bc8a77-bba7-4635-87b0-042283ed865c
      version: -1
      name: Get status cases
      script: McAfee ESM-v10|||esm-get-case-statuses
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "24"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3665
        }
      }
  "24":
    id: "24"
    taskid: 007864a4-476b-4e5f-879a-7b66bdaffacb
    type: regular
    task:
      id: 007864a4-476b-4e5f-879a-7b66bdaffacb
      version: -1
      name: Get cases
      script: McAfee ESM-v10|||esm-get-case-list
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "25"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3840
        }
      }
  "25":
    id: "25"
    taskid: 63ad150a-01c3-4075-85c1-8cd65a7ecef9
    type: regular
    task:
      id: 63ad150a-01c3-4075-85c1-8cd65a7ecef9
      version: -1
      name: Get users
      script: McAfee ESM-v10|||esm-get-user-list
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    nexttasks:
      '#none#':
      - "26"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4015
        }
      }
  "26":
    id: "26"
    taskid: e7a7b6d2-963b-443b-8bfa-f2aa6d29d928
    type: regular
    task:
      id: e7a7b6d2-963b-443b-8bfa-f2aa6d29d928
      version: -1
      name: Get organizations
      script: McAfee ESM-v10|||esm-get-organization-list
      type: regular
      iscommand: true
      brand: McAfee ESM-v10
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4190
        }
      }
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4235,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []

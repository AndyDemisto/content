commonfields:
  id: PTEnrich
  version: -1
name: PTEnrich
script: |
  var res = [];
  var commands = ['pt-get-subdomains', 'pt-passive-dns', 'pt-whois', 'pt-ssl-cert', 'pt-enrichment', 'pt-malware', 'pt-osint'];
  for (var i in commands) {
      var r = executeCommand(commands[i], {query: args.query});
      if (isError(r[0])) {
          return r[0];
      }
      res.push(r[0]);
  }
  return res;
type: javascript
tags:
- passive-total
- server
- threat-intel
comment: Enrich the given IP or domain with metadata, malware, osint
system: true
args:
- name: query
  required: true
  default: true
  description: The IP or domain to enrich
outputs:
- contextPath: subdomains
  description: List of subdomains as strings
- contextPath: Domain.Name
  description: The name of the queries domain
- contextPath: Domain.DNS.Address
  description: The resolved address of the domain
- contextPath: passivetotal.whois.email
  description: Contact email for the queried domain
- contextpath: passivetotal.resolves
  description: The various resolves from the passive DNS collection
- contextPath: IP/Malicious.Address
  description: Bad IPs found during enrichment
- contextPath: Domain/Malicious.Name
  description: Bad domains found during enrichment
- contextPath: File/Malicious.MD5
  description: Bad hash MD5
- contextPath: File/Malicious.SHA1
  description: Bad hash SHA1
- contextPath: File/Malicious.SHA256
  description: Bad hash SHA256
- contextPath: dbotScore.indicator
  description: The indicator we tested
- contextPath: dbotScore.type
  description: The type of the indicator
- contextPath: dbotScore.vendor
  description: Vendor used to calculate the score
- contextPath: dbotScore.score
  description: The actual score
important:
- contextPath: File/Malicious
  description: Malicious Files
  related: File
- contextPath: IP/Malicious
  description: Malicious IPs
  related: IP
- contextPath: Domain/Malicious
  description: Malicious Domains
  related: Domain
scripttarget: 0
dependson:
  must:
  - pt-enrichment
  - pt-malware
  - pt-osint
  - pt-get-subdomains
  - pt-passive-dns
  - pt-whois
  - pt-ssl-cert
timeout: 0s

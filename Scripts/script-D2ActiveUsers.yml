commonfields:
  id: D2ActiveUsers
  version: -1
name: D2ActiveUsers
script: |-
  function usersUnix() {
    packOutput('cat /etc/passwd');
  }
  function usersWindows() {
      pack(wmi_query('select * from Win32_LoggedOnUser'),'table');
  }
  try {
    if (env.OS === 'windows') {
      usersWindows();
    } else {
      usersUnix();
    }
  } catch (ex) {
    pack('Error: ' + ex);
  }
type: javascript
tags:
- agent
- endpoint
comment: Show local accounts
system: true
scripttarget: 1
